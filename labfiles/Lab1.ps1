# Looking below is cheating, don't be that person


























































































































































































































































































































































































































































































































































































































































































































































# Looking below is cheating, don't be that person

























































































































































































































































































































































































































































































































































































































































































































































# Lab 1

# Enable the Administrator user.
[void] (net user Administrator YouShouldReallyReadT4381873 /active:yes)


# Add some data to be found.
[void] (reg add HKLM\Software\VNCServer)
[void] (reg add HKLM\Software\VNCServer /v VNCPassword /d "YouShouldReallyReadT4381873")
[void] (reg add HKLM\Software\VNCServer /v Version /d "v 1.0")
[void] (reg add HKLM\Software\VNCServer /v Host /d "localhost")
[void] (reg add HKLM\Software\VNCServer /v Username /d "Administrator")
[void] (reg add HKLM\Software\VNCServer /v Author /d "TCE ITS")

# -----

# Lab 2

# Insert run script in to IEUser's Startup Directory
[void] ($acl = Get-Acl HKLM:\SYSTEM\CurrentControlSet\Services\OpenSSHd)
[void] ($rule = New-Object System.Security.AccessControl.RegistryAccessRule ("Teacher","FullControl","Allow"))
[void] ($acl.SetAccessRule($rule))
[void] ($acl |Set-Acl -Path HKLM:\SYSTEM\CurrentControlSet\Services\OpenSSHd)
[void] (cmd /c "sc sdset OpenSSHd D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWLOCRRC;;;IU)(A;;CCLCSWLOCRRC;;;SU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-1716914095-909560446-1177810406-1005)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)")

# -----

# Lab 3

# Set the appropriate unquoated service here, changing the officeClickToRun to Unquoted within Registry
[void] ($regPath = "HKLM:\SYSTEM\CurrentControlSet\Services\ClickToRunSVC\")
[void] ($name = "ImagePath")
[void] ($value = 'C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe')
[void] (New-ItemProperty -path $regPath -name $name -Value $value -Force)

# Now we need to change the permissions of a very specific folder
[void] (Takeown /F "C:\Program Files\Common Files")
[void] (icacls "C:\Program Files\Common Files" /grant 'teacher:(S,RD,WD,AD,REA,X,RA)')

